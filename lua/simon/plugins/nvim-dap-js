return {
  event = 'VeryLazy',
  'microsoft/vscode-js-debug',
  -- build = "npm install --legacy-peer-deps && npx gulp vsDebugServerBundle && mv dist out",
  requires = { 'mfussenegger/nvim-dap' },
  config = function()
    require('dap-vscode-js').setup {

      -- Uncomment and set the debugger_path if you have a custom installation path for vscode-js-debug
      debugger_path = '/home/simon/.config/vscode-js-debug',
      adapters = { 'chrome', 'pwa-node', 'pwa-chrome', 'pwa-msedge', 'node-terminal', 'pwa-extensionHost', 'node', 'chrome' },
    }

    local js_based_languages = { 'typescript', 'javascript', 'typescriptreact', 'javascriptreact' }
    for _, language in ipairs(js_based_languages) do
      require('dap').configurations[language] = {
        -- this setup is
        {
          type = 'pwa-node',
          request = 'launch',
          name = 'Launch via npm run dev',
          sourceMaps = true,
          runtimeExecutable = 'npm',
          runtimeArgs = { 'run', 'dev' },
          port = 8081, -- Default debug port for Node.js (make sure your npm start script uses this port for debugging)
          cwd = '${workspaceFolder}',
          skipFiles = { '<node_internals>/**' }, -- Skip over node internal files while debugging
          -- env = {
          -- }
        },
        --   {
        --     type = "pwa-node",
        --     request = "launch",
        --     name = "Launch file",
        --     program = '${workspaceFolder}/node_modules/next/dist/bin/next',
        --     command = "npm run dev",
        --     cwd = "${workspaceFolder}",
        --   },
        --   {
        --     type = "pwa-node",
        --     request = "attach",
        --     name = "Attach",
        --     processId = require 'dap.utils'.pick_process,
        --     cwd = "${workspaceFolder}",
        --   },
        --   {
        --     type = "pwa-chrome",
        --     request = "launch",
        --     name = "Start Chrome with \"localhost\"",
        --     url = "http://localhost:3000",
        --     webRoot = "${workspaceFolder}",
        --     userDataDir = "${workspaceFolder}/.vscode/vscode-chrome-debug-userdatadir"
        --   }
      }
    end
  end,
}
